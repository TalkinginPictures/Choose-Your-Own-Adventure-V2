<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Hero Trickster Game</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 20px; background: #f4f4f9; }
    h1 { color: #333; }
    #game { margin-top: 20px; }
    .option { display: inline-block; margin: 10px; padding: 10px; background: white; border: 2px solid #ccc; border-radius: 10px; width: 200px; cursor: pointer; transition: transform 0.2s; }
    .option:hover { transform: scale(1.05); border-color: #666; }
    .option img { width: 180px; height: 120px; object-fit: cover; border-radius: 8px; }
    #result { margin-top: 20px; font-size: 20px; }
    #score { margin-top: 10px; font-size: 18px; color: #555; }
  </style>
</head>
<body>
  <h1>Hero vs Trickster</h1>
  <p>Choose the correct archetype for each image!</p>
  <div id="game"></div>
  <div id="result"></div>
  <div id="score">Score: 0</div>

  <script>
    const PIXABAY_API_KEY = "49978957-7f3f3c500656460c1f5b4026f";

    const archetypes = [
      { name: "Hero", keyword: "Hero" },
      { name: "Trickster", keyword: "Trickster" },
      { name: "Samurai", keyword: "Samurai" },
      { name: "Warrior", keyword: "Warrior" },
      { name: "Wizard", keyword: "Wizard" },
    ];

    // ✅ Hardcoded fallback images
    const fallbackImages = {
      "Samurai": "https://upload.wikimedia.org/wikipedia/commons/thumb/c/c6/Samurai_with_katana2.jpg/320px-Samurai_with_katana2.jpg",
      "Trickster": "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3e/Jester_Foolstock_1.png/320px-Jester_Foolstock_1.png"
    };

    let score = 0;

    async function fetchImage(keyword) {
      // Check for hardcoded fallback
      if (fallbackImages[keyword]) {
        return fallbackImages[keyword];
      }

      // Try Pixabay
      const response = await fetch(`https://pixabay.com/api/?key=${PIXABAY_API_KEY}&q=${encodeURIComponent(keyword)}&image_type=photo&per_page=10&safesearch=true`);
      const data = await response.json();
      if (data.hits && data.hits.length > 0) {
        return data.hits[0].webformatURL;
      }

      // Final fallback
      return "https://via.placeholder.com/180x120.png?text=" + encodeURIComponent(keyword);
    }

    async function newRound() {
      document.getElementById("game").innerHTML = "Loading images...";

      const correct = archetypes[Math.floor(Math.random() * archetypes.length)];
      const wrong = archetypes[Math.floor(Math.random() * archetypes.length)];
      if (correct.name === wrong.name) return newRound();

      const correctImg = await fetchImage(correct.keyword);
      const wrongImg = await fetchImage(wrong.keyword);

      const options = [
        { archetype: correct.name, img: correctImg, correct: true },
        { archetype: wrong.name, img: wrongImg, correct: false }
      ];

      // Shuffle
      options.sort(() => Math.random() - 0.5);

      document.getElementById("game").innerHTML = options.map(opt => `
        <div class="option" onclick="choose(${opt.correct})">
          <img src="${opt.img}" alt="${opt.archetype}">
          <p>${opt.archetype}</p>
        </div>
      `).join("");
    }

    function choose(correct) {
      if (correct) {
        document.getElementById("result").innerText = "✅ Correct!";
        score++;
      } else {
        document.getElementById("result").innerText = "❌ Wrong!";
        score--;
      }
      document.getElementById("score").innerText = "Score: " + score;
      setTimeout(newRound, 1000);
    }

    newRound();
  </script>
</body>
</html>
